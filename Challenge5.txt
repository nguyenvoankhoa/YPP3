-- SELECT DAYOFWEEK(week_date) AS day_of_week
-- FROM data_mart.clean_weekly_sales;
-- select year_num, sum(year_num) from clean_weekly_sales group by year_num
-- select year_num, sum(transactions) from clean_weekly_sales group by year_num

-- What is the percentage of sales for Retail vs Shopify for each month?
-- select month_num, year_num, 
-- round(100*max(case when platform = 'Shopify' then monthly_sale else null end) / sum(monthly_sale), 2) as shopify_sale,
-- round(100*max(case when platform = 'Retail' then monthly_sale else null end) / sum(monthly_sale), 2) as retail_sale
-- from ( 
-- select sum(sales) as monthly_sale, month_num, platform, year_num
-- from clean_weekly_sales group by month_num, platform, year_num 
-- ) as cte_table group by month_num, year_num

-- What is the percentage of sales by demographic for each year in the dataset?
-- select year_num, 
-- 100* max(case when demographic = 'Couples' then total else null end) / sum(total) as couple_rate,
-- 100* max(case when demographic = 'Families' then total else null end) / sum(total) as family_rate,
-- 100* max(case when demographic = 'unknown' then total else null end) / sum(total) as unknown_rate
-- from ( 
-- select demographic, year_num, sum(sales) as total from clean_weekly_sales group by year_num, demographic
-- ) as cte group by year_num
-- Which age_band and demographic values contribute the most to Retail sales?
-- select age_band, demographic, sum(sales)as total_sale from clean_weekly_sales  group by age_band, demographic order by total_sale desc

-- Can we use the avg_transaction column to find the average transaction size for each year for Retail vs Shopify? If not - how would you calculate it instead?
-- select year_num, platform, avg(avg_transaction) from clean_weekly_sales group by year_num, platform