What was the total quantity sold for all products?
select sum(qty) as total_qty from sales

What is the total generated revenue for all products before discounts?
select sum(qty * price) as revenue from sales; 

What was the total discount amount for all products?
select sum(discount) as total_discount from sales



How many unique transactions were there?
select count(distinct txn_id) as unique_trans from sales
What is the average unique products purchased in each transaction?
select avg(total) from (select txn_id, sum(qty) as total from sales group by txn_id) as cte
What are the 25th, 50th and 75th percentile values for the revenue per transaction?
with cte as (select txn_id , sum(price * qty) as revenue, ntile(4) over (order by sum(price * qty)) as ranking from sales group by txn_id)
select max(case when ranking = 1 then revenue else 0 end) as 25_th, 
max(case when ranking = 2 then revenue else 0 end) as 50_th,
max(case when ranking = 3 then revenue else 0 end) as 75_th
from cte
What is the average discount value per transaction?
select avg(total_discount) from ( select txn_id , sum(qty * price * discount / 100) as total_discount from sales group by txn_id) as cte
What is the percentage split of all transactions for members vs non-members?
select 100 *sum(case when member = 't' then 1 else 0 end) / count(*) as member_pct from sales
What is the average revenue for member transactions and non-member transactions?
select avg(revenue), member from (
select member, txn_id ,sum(price * qty) as revenue from sales group by member, txn_id
) as cte group by member


